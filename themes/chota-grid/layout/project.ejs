<article class="post project">
  <header style="margin-bottom:1rem">
    <span>
      <%- partial('_partial/date', {post: page}) %>
    </span>

    <h1 class="post--title">
      <%- page.title %>
    </h1>
    <h2 class="post--subtitle">
      <%- page.subtitle %>
    </h2>
    <span style="display: flex;flex-wrap: wrap;">
      <%- list_categories(page.categories, { show_count: false, class: 'clean category tag', separator: "|" }) %>
      <%- list_tags(page.tags, { show_count: false, class: 'clean tag' }) %>
    </span>
    <p></p>
    <p class="post--meta">
      Client | <%= page.project[0].client %>
    </p>
  </header>

  <main>
    <% project = page.project[0] %>
    <% images = project.images %>
    <% tech = page.project[0].tech %>
    <p>
      <% if (project.url) {%><a href="<%= project.url %>" target="_blank" class="img"><%}%>
        <img id="project-images" class="project--image" src="/assets/img/md_<%= project.images[0] %>.webp" alt="<%= page.title %>">
      <% if (project.url) {%></a><%}%>
    </p>
    <p>
      <%- markdown(page.project[0].description) %>
    </p>
    <% if (page.project[0].iframe) {%>
      <p><iframe src="<%= project.url %>" frameborder="0" allowfullscreen width="100%" height="550" scrolling="no" style="overflow: hidden" ></iframe></p>
    <% } %>
    <p>
      <% if (project.url) {%><a href="<%= project.url %>" target="_blank"  style="display:inline-flex;align-items:center"><img  style="margin-right: 5px" src="/assets/icons/external-link.svg" alt="project-link">&nbsp;Live Demo</a><%}%>
    </p>

    <% if (project.repo) {%><p><a href="<%= project.repo %>" target="_blank"  style="display:inline-flex;align-items:center;"><img style="margin-right: 5px" src="https://icongr.am/fontawesome/github.svg?size=22&color=currentColor" alt="project-link">GitHub</a></p><%}%>
    <!-- <p>
      <% for (i = 0; i < page.project[0]?.tech?.length; i++) {%>
        <span class="project-tag"><%= tech[i] %></span>
      <%}%>
    </p>    -->
    <p style="margin-top:4rem">
      <a href="/projects" class="btn">View Project List</a>
    </p>
  </main>
</article>
<section class="inverse">
  <h2 class="section--heading">Featured Projects</h2>
  <div class="featured">
    <% site.categories.sort('name').map(function(category){ %>
      <% if(category.name == 'featured' ) { %>
        <% category.posts.sort('date', -1).each(function(post, i) {%>
          <% if ((post.title != page.title) && (i < 3)) {%>
            <%- partial('_partial/post_card', {post: post}) %>
          <%}%>
        <%})%>
      <% } %>
    <% }) %>
  </div>
</section>

<% if (images.length > 1 ) {%>
  <script>
    const images = ["<%= project.images[0] %>","<%= project.images[1] %>"];
    const div = document.querySelector("#project-images");
    div.style.cursor = "pointer"
    let currentImage = 0;
    setInterval(() => {
      currentImage = (!currentImage) ? 1 : 0;
      div.src = "/assets/img/md_" + images[currentImage] + ".webp"
    }, 4000);
  </script>
<%}%>

<script>
  const iframe = document.querySelector("iframe");
</script>